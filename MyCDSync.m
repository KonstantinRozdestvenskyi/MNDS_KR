function Y = MyCDSync(X, a, h, S, K)
    %Pecora-Carroll synchronization
    
    Y = X;

    N(1) = K(1) * (S(1) - X(1));
    N(2) = K(2) * (S(2) - X(2));
    N(3) = K(3) * (S(3) - X(3));
    N(4) = K(4) * (S(4) - X(4));
    
    h1 = h * 0.5; %a(1) - symmetry coefficient
    h2 = h * (1 - 0.5);

    
    % X(1) = X(1) + h1 * ( a(1) * ( X(2) - X(1)) + N(1));
    % X(2) = X(2) + h1 * ( X(1) * ( a(2) - X(3)) - X(2) + N(2));
    % X(3) = X(3) + h1 * ( X(1) * X(2) - a(3) * X(3) + N(3));

    X(1) = X(1) + h1 * (a(1) * X(2) * X(4) + N(1));
    X(2) = X(2) + h1 * (a(6) * X(2) * X(3) + N(2));
    X(3) = X(3) + h1 * (-a(2) * (X(2))^2 + a(3) * X(4) + N(3));
    X(4) = X(4) + h1 * (-a(4) * X(1) * X(2) - a(5) * (X(3))^3 + N(4));
    
    % X(3) = (X(3) + h2 * ( X(1) * X(2) + N(3)))/(1 + h2*a(3));
    % X(2) = (X(2) + h2 * ( X(1) * ( a(2) - X(3)) + N(2)))/(1 + h2);
    % X(1) = (X(1) + h2 * ( a(1) * ( X(2)) + N(1)))/(1 + a(1)*h2);

    X(4) = X(4) + h2 * (-a(4) * X(1) * X(2) - a(5) * (X(3))^3 + N(4));
    X(3) = X(3) + h2 * (-a(2) * (X(2))^2 + a(3) * X(4) + N(3));
    X(2) = (X(2) + h2 * N(2))/(1 - h2 * a(6) * X(3));
    X(1) = X(1) + h2 * (a(1) * X(2) * X(4) + N(1));
    
    Y(1) = X(1);
    Y(2) = X(2);
    Y(3) = X(3);
    Y(4) = X(4);
end